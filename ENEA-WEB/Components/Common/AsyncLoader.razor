@using Blazored.LocalStorage
@using Generated.Client
@typeparam T
@inject MyApiClient client;
@attribute [StreamRendering]
@attribute [RenderModeInteractiveServer]

@code {

    [Parameter] public Func<IMyApiClient, Task<T>> Accessor { get; set; }

    [Parameter] public RenderFragment Loader { get; set; }
    [Parameter] public RenderFragment<T> Render { get; set; }

    private T item;
    private Boolean isLoading = true;

    protected override async Task OnAfterRenderAsync(Boolean first)
    {
        if (first)
        {
            item = await Accessor(client);
            isLoading = false;
        }
    }
}

@if (isLoading)
{
    @Loader
}
else
{
    @Render(item)
}